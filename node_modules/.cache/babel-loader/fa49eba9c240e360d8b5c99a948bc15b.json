{"ast":null,"code":"import _regeneratorRuntime from\"/home/runner/work/watchparty/watchparty/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/runner/work/watchparty/watchparty/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/home/runner/work/watchparty/watchparty/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/runner/work/watchparty/watchparty/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/home/runner/work/watchparty/watchparty/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/home/runner/work/watchparty/watchparty/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import'./index.css';import'semantic-ui-css/semantic.min.css';import React,{lazy,Suspense}from'react';import ReactDOM from'react-dom';import{BrowserRouter,Route}from'react-router-dom';import App from'./components/App';import{Home}from'./components/Home';import{Privacy,Terms,FAQ}from'./components/PrivacyTerms/PrivacyTerms';import{TopBar}from'./components/TopBar/TopBar';import{Footer}from'./components/Footer/Footer';import*as serviceWorker from'./serviceWorker';import firebase from'firebase/compat/app';import'firebase/auth';import{serverPath}from'./utils';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Debug=/*#__PURE__*/lazy(function(){return import('./components/Debug/Debug');});var firebaseConfig=process.env.REACT_APP_FIREBASE_CONFIG;if(firebaseConfig){firebase.initializeApp(JSON.parse(firebaseConfig));}var WatchParty=/*#__PURE__*/function(_React$Component){_inherits(WatchParty,_React$Component);var _super=_createSuper(WatchParty);function WatchParty(){var _this;_classCallCheck(this,WatchParty);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state={user:undefined,isSubscriber:false,isCustomer:false};return _this;}_createClass(WatchParty,[{key:\"componentDidMount\",value:function(){var _componentDidMount=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var _this2=this;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(firebaseConfig){firebase.auth().onAuthStateChanged(/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(user){var token,response,data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!user){_context.next=12;break;}// console.log(user);\n_this2.setState({user:user});_context.next=4;return user.getIdToken();case 4:token=_context.sent;_context.next=7;return window.fetch(serverPath+\"/metadata?uid=\".concat(user.uid,\"&token=\").concat(token));case 7:response=_context.sent;_context.next=10;return response.json();case 10:data=_context.sent;_this2.setState({isSubscriber:data.isSubscriber,isCustomer:data.isCustomer});case 12:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}());}case 1:case\"end\":return _context2.stop();}}},_callee2);}));function componentDidMount(){return _componentDidMount.apply(this,arguments);}return componentDidMount;}()},{key:\"render\",value:function render(){var _this3=this;return/*#__PURE__*/_jsx(React.StrictMode,{children:/*#__PURE__*/_jsxs(BrowserRouter,{children:[/*#__PURE__*/_jsx(Route,{path:\"/\",exact:true,render:function render(props){var _props$location;if((_props$location=props.location)===null||_props$location===void 0?void 0:_props$location.hash){return/*#__PURE__*/_jsx(App,{user:_this3.state.user,isSubscriber:_this3.state.isSubscriber,isCustomer:_this3.state.isCustomer});}return/*#__PURE__*/_jsxs(React.Fragment,{children:[/*#__PURE__*/_jsx(TopBar,{user:_this3.state.user,isSubscriber:_this3.state.isSubscriber,isCustomer:_this3.state.isCustomer,hideNewRoom:true}),/*#__PURE__*/_jsx(Home,{user:_this3.state.user}),/*#__PURE__*/_jsx(Footer,{})]});}}),/*#__PURE__*/_jsx(Route,{path:\"/r/:vanity\",exact:true,render:function render(props){return/*#__PURE__*/_jsx(App,{user:_this3.state.user,isSubscriber:_this3.state.isSubscriber,isCustomer:_this3.state.isCustomer,vanity:props.match.params.vanity});}}),/*#__PURE__*/_jsxs(Route,{path:\"/terms\",children:[/*#__PURE__*/_jsx(TopBar,{user:this.state.user,isSubscriber:this.state.isSubscriber,isCustomer:this.state.isCustomer}),/*#__PURE__*/_jsx(Terms,{}),/*#__PURE__*/_jsx(Footer,{})]}),/*#__PURE__*/_jsxs(Route,{path:\"/privacy\",children:[/*#__PURE__*/_jsx(TopBar,{user:this.state.user,isSubscriber:this.state.isSubscriber,isCustomer:this.state.isCustomer}),/*#__PURE__*/_jsx(Privacy,{}),/*#__PURE__*/_jsx(Footer,{})]}),/*#__PURE__*/_jsxs(Route,{path:\"/faq\",children:[/*#__PURE__*/_jsx(TopBar,{user:this.state.user,isSubscriber:this.state.isSubscriber,isCustomer:this.state.isCustomer}),/*#__PURE__*/_jsx(FAQ,{}),/*#__PURE__*/_jsx(Footer,{})]}),/*#__PURE__*/_jsxs(Route,{path:\"/debug\",children:[/*#__PURE__*/_jsx(TopBar,{user:this.state.user,isSubscriber:this.state.isSubscriber,isCustomer:this.state.isCustomer}),/*#__PURE__*/_jsx(Suspense,{fallback:null,children:/*#__PURE__*/_jsx(Debug,{})}),/*#__PURE__*/_jsx(Footer,{})]})]})});}}]);return WatchParty;}(React.Component);ReactDOM.render(/*#__PURE__*/_jsx(WatchParty,{}),document.getElementById('root'));// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();","map":{"version":3,"sources":["/home/runner/work/watchparty/watchparty/src/index.tsx"],"names":["React","lazy","Suspense","ReactDOM","BrowserRouter","Route","App","Home","Privacy","Terms","FAQ","TopBar","Footer","serviceWorker","firebase","serverPath","Debug","firebaseConfig","process","env","REACT_APP_FIREBASE_CONFIG","initializeApp","JSON","parse","WatchParty","state","user","undefined","isSubscriber","isCustomer","auth","onAuthStateChanged","setState","getIdToken","token","window","fetch","uid","response","json","data","props","location","hash","match","params","vanity","Component","render","document","getElementById","unregister"],"mappings":"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","sourcesContent":["import './index.css';\nimport 'semantic-ui-css/semantic.min.css';\n\nimport React, { lazy, Suspense } from 'react';\nimport ReactDOM from 'react-dom';\nimport { BrowserRouter, Route } from 'react-router-dom';\n\nimport App from './components/App';\nimport { Home } from './components/Home';\nimport { Privacy, Terms, FAQ } from './components/PrivacyTerms/PrivacyTerms';\nimport { TopBar } from './components/TopBar/TopBar';\nimport { Footer } from './components/Footer/Footer';\nimport * as serviceWorker from './serviceWorker';\nimport firebase from 'firebase/compat/app';\nimport 'firebase/auth';\nimport { serverPath } from './utils';\n\nconst Debug = lazy(() => import('./components/Debug/Debug'));\n\nconst firebaseConfig = process.env.REACT_APP_FIREBASE_CONFIG;\nif (firebaseConfig) {\n  firebase.initializeApp(JSON.parse(firebaseConfig));\n}\n\nclass WatchParty extends React.Component {\n  public state = {\n    user: undefined as firebase.User | undefined,\n    isSubscriber: false,\n    isCustomer: false,\n  };\n  async componentDidMount() {\n    if (firebaseConfig) {\n      firebase.auth().onAuthStateChanged(async (user: firebase.User | null) => {\n        if (user) {\n          // console.log(user);\n          this.setState({ user });\n          const token = await user.getIdToken();\n          const response = await window.fetch(\n            serverPath + `/metadata?uid=${user.uid}&token=${token}`\n          );\n          const data = await response.json();\n          this.setState({\n            isSubscriber: data.isSubscriber,\n            isCustomer: data.isCustomer,\n          });\n        }\n      });\n    }\n  }\n  render() {\n    return (\n      <React.StrictMode>\n        <BrowserRouter>\n          <Route\n            path=\"/\"\n            exact\n            render={(props) => {\n              if (props.location?.hash) {\n                return (\n                  <App\n                    user={this.state.user}\n                    isSubscriber={this.state.isSubscriber}\n                    isCustomer={this.state.isCustomer}\n                  />\n                );\n              }\n              return (\n                <React.Fragment>\n                  <TopBar\n                    user={this.state.user}\n                    isSubscriber={this.state.isSubscriber}\n                    isCustomer={this.state.isCustomer}\n                    hideNewRoom\n                  />\n                  <Home user={this.state.user} />\n                  <Footer />\n                </React.Fragment>\n              );\n            }}\n          />\n          <Route\n            path=\"/r/:vanity\"\n            exact\n            render={(props) => {\n              return (\n                <App\n                  user={this.state.user}\n                  isSubscriber={this.state.isSubscriber}\n                  isCustomer={this.state.isCustomer}\n                  vanity={props.match.params.vanity}\n                />\n              );\n            }}\n          />\n          <Route path=\"/terms\">\n            <TopBar\n              user={this.state.user}\n              isSubscriber={this.state.isSubscriber}\n              isCustomer={this.state.isCustomer}\n            />\n            <Terms />\n            <Footer />\n          </Route>\n          <Route path=\"/privacy\">\n            <TopBar\n              user={this.state.user}\n              isSubscriber={this.state.isSubscriber}\n              isCustomer={this.state.isCustomer}\n            />\n            <Privacy />\n            <Footer />\n          </Route>\n          <Route path=\"/faq\">\n            <TopBar\n              user={this.state.user}\n              isSubscriber={this.state.isSubscriber}\n              isCustomer={this.state.isCustomer}\n            />\n            <FAQ />\n            <Footer />\n          </Route>\n          <Route path=\"/debug\">\n            <TopBar\n              user={this.state.user}\n              isSubscriber={this.state.isSubscriber}\n              isCustomer={this.state.isCustomer}\n            />\n            <Suspense fallback={null}>\n              <Debug />\n            </Suspense>\n            <Footer />\n          </Route>\n        </BrowserRouter>\n      </React.StrictMode>\n    );\n  }\n}\nReactDOM.render(<WatchParty />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"]},"metadata":{},"sourceType":"module"}