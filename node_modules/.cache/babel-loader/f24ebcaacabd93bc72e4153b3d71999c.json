{"ast":null,"code":"import _objectSpread from\"/home/runner/work/watchparty/watchparty/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _regeneratorRuntime from\"/home/runner/work/watchparty/watchparty/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/runner/work/watchparty/watchparty/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/home/runner/work/watchparty/watchparty/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/runner/work/watchparty/watchparty/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/home/runner/work/watchparty/watchparty/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/home/runner/work/watchparty/watchparty/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React from'react';import{debounce,getYouTubeResults,getMediaPathResults,getStreamPathResults}from'../../utils';import{Dropdown}from'semantic-ui-react';import{YouTubeSearchResult,MediaPathSearchResult,StreamPathSearchResult}from'../SearchResult/SearchResult';import{jsx as _jsx}from\"react/jsx-runtime\";export var SearchComponent=/*#__PURE__*/function(_React$Component){_inherits(SearchComponent,_React$Component);var _super=_createSuper(SearchComponent);function SearchComponent(){var _this;_classCallCheck(this,SearchComponent);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state={results:[],resetDropdown:Number(new Date()),loading:false,lastResultTimestamp:Number(new Date()),inputMedia:undefined};_this.debounced=null;_this.doSearch=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(e){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:e.persist();_this.setState({inputMedia:e.target.value},function(){if(!_this.debounced){_this.debounced=debounce(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var query,results,timestamp;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_this.setState({loading:true});query=_this.state.inputMedia||'';results=[];timestamp=Number(new Date());if(!(_this.props.type==='youtube')){_context.next=10;break;}_context.next=7;return getYouTubeResults(query);case 7:results=_context.sent;_context.next=20;break;case 10:if(!(_this.props.type==='media'&&_this.props.mediaPath)){_context.next=16;break;}_context.next=13;return getMediaPathResults(_this.props.mediaPath,query);case 13:results=_context.sent;_context.next=20;break;case 16:if(!(_this.props.type==='stream'&&_this.props.streamPath)){_context.next=20;break;}_context.next=19;return getStreamPathResults(_this.props.streamPath,query);case 19:results=_context.sent;case 20:if(timestamp>_this.state.lastResultTimestamp){_this.setState({loading:false,results:results,lastResultTimestamp:timestamp});}case 21:case\"end\":return _context.stop();}}},_callee);})),500);}_this.debounced();});case 2:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x){return _ref.apply(this,arguments);};}();_this.setMedia=function(e,data){window.setTimeout(function(){return _this.setState({resetDropdown:Number(new Date())});},300);_this.props.setMedia(e,data);};return _this;}_createClass(SearchComponent,[{key:\"render\",value:function render(){var _this2=this;var setMedia=this.setMedia;var placeholder='Search streams';var icon='film';if(this.props.type==='youtube'){placeholder='Search YouTube';icon='youtube';}else if(this.props.type==='media'){placeholder=this.props.mediaPath||'';icon='file';}if(this.state.loading){icon='loading circle notch';}return/*#__PURE__*/_jsx(React.Fragment,{children:/*#__PURE__*/_jsx(Dropdown,{fluid:true,style:{height:'36px'},button:true,icon:icon,className:\"icon\",labeled:true,disabled:this.props.disabled,search:function search(){},text:placeholder,onSearchChange:this.doSearch,onFocus:/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(e){return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:if(_this2.props.type==='media'&&_this2.props.mediaPath){_this2.doSearch(e);}case 1:case\"end\":return _context3.stop();}}},_callee3);}));return function(_x2){return _ref3.apply(this,arguments);};}(),scrolling:true// onBlur={() => this.setState({ results: this.state.watchOptions })}\n//searchQuery={this.state.query}\n//loading={this.state.loading}\n,children:Boolean(this.state.results.length)?/*#__PURE__*/_jsx(Dropdown.Menu,{children:this.state.results.map(function(result){if(_this2.props.type==='youtube'){return/*#__PURE__*/_jsx(YouTubeSearchResult,_objectSpread(_objectSpread({},result),{},{setMedia:setMedia,playlistAdd:_this2.props.playlistAdd}),result.url);}else if(_this2.props.type==='media'){return/*#__PURE__*/_jsx(MediaPathSearchResult,_objectSpread(_objectSpread({},result),{},{setMedia:setMedia}),result.url);}return/*#__PURE__*/_jsx(StreamPathSearchResult,_objectSpread(_objectSpread({},result),{},{setMedia:setMedia,launchMultiSelect:_this2.props.launchMultiSelect,streamPath:_this2.props.streamPath||''}),result.url);})}):null},this.state.resetDropdown)});}}]);return SearchComponent;}(React.Component);","map":{"version":3,"sources":["/home/runner/work/watchparty/watchparty/src/components/SearchComponent/SearchComponent.tsx"],"names":["React","debounce","getYouTubeResults","getMediaPathResults","getStreamPathResults","Dropdown","YouTubeSearchResult","MediaPathSearchResult","StreamPathSearchResult","SearchComponent","state","results","resetDropdown","Number","Date","loading","lastResultTimestamp","inputMedia","undefined","debounced","doSearch","e","persist","setState","target","value","query","timestamp","props","type","mediaPath","streamPath","setMedia","data","window","setTimeout","placeholder","icon","height","disabled","Boolean","length","map","result","playlistAdd","url","launchMultiSelect","Component"],"mappings":"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","sourcesContent":["import React from 'react';\nimport {\n  debounce,\n  getYouTubeResults,\n  getMediaPathResults,\n  getStreamPathResults,\n} from '../../utils';\nimport { DropdownProps, Dropdown } from 'semantic-ui-react';\nimport {\n  YouTubeSearchResult,\n  MediaPathSearchResult,\n  StreamPathSearchResult,\n} from '../SearchResult/SearchResult';\n\ninterface SearchComponentProps {\n  setMedia: Function;\n  playlistAdd: Function;\n  type?: 'youtube' | 'media' | 'stream';\n  launchMultiSelect?: Function;\n  mediaPath: string | undefined;\n  streamPath: string | undefined;\n  disabled?: boolean;\n}\n\nexport class SearchComponent extends React.Component<SearchComponentProps> {\n  state = {\n    results: [] as SearchResult[],\n    resetDropdown: Number(new Date()),\n    loading: false,\n    lastResultTimestamp: Number(new Date()),\n    inputMedia: undefined,\n  };\n  debounced: any = null;\n\n  doSearch = async (e: any) => {\n    e.persist();\n    this.setState({ inputMedia: e.target.value }, () => {\n      if (!this.debounced) {\n        this.debounced = debounce(async () => {\n          this.setState({ loading: true });\n          let query = this.state.inputMedia || '';\n          let results: SearchResult[] = [];\n          let timestamp = Number(new Date());\n          if (this.props.type === 'youtube') {\n            results = await getYouTubeResults(query);\n          } else if (this.props.type === 'media' && this.props.mediaPath) {\n            results = await getMediaPathResults(this.props.mediaPath, query);\n          } else if (this.props.type === 'stream' && this.props.streamPath) {\n            results = await getStreamPathResults(this.props.streamPath, query);\n          }\n          if (timestamp > this.state.lastResultTimestamp) {\n            this.setState({\n              loading: false,\n              results,\n              lastResultTimestamp: timestamp,\n            });\n          }\n        }, 500);\n      }\n      this.debounced();\n    });\n  };\n\n  setMedia = (e: any, data: DropdownProps) => {\n    window.setTimeout(\n      () => this.setState({ resetDropdown: Number(new Date()) }),\n      300\n    );\n    this.props.setMedia(e, data);\n  };\n\n  render() {\n    const setMedia = this.setMedia;\n    let placeholder = 'Search streams';\n    let icon = 'film';\n    if (this.props.type === 'youtube') {\n      placeholder = 'Search YouTube';\n      icon = 'youtube';\n    } else if (this.props.type === 'media') {\n      placeholder = this.props.mediaPath || '';\n      icon = 'file';\n    }\n    if (this.state.loading) {\n      icon = 'loading circle notch';\n    }\n    return (\n      <React.Fragment>\n        <Dropdown\n          key={this.state.resetDropdown}\n          fluid\n          style={{ height: '36px' }}\n          button\n          icon={icon}\n          className=\"icon\"\n          labeled\n          disabled={this.props.disabled}\n          search={(() => {}) as any}\n          text={placeholder}\n          onSearchChange={this.doSearch}\n          onFocus={async (e) => {\n            if (this.props.type === 'media' && this.props.mediaPath) {\n              this.doSearch(e);\n            }\n          }}\n          scrolling\n          // onBlur={() => this.setState({ results: this.state.watchOptions })}\n          //searchQuery={this.state.query}\n          //loading={this.state.loading}\n        >\n          {Boolean(this.state.results.length) ? (\n            <Dropdown.Menu>\n              {this.state.results.map((result: SearchResult) => {\n                if (this.props.type === 'youtube') {\n                  return (\n                    <YouTubeSearchResult\n                      key={result.url}\n                      {...result}\n                      setMedia={setMedia}\n                      playlistAdd={this.props.playlistAdd}\n                    />\n                  );\n                } else if (this.props.type === 'media') {\n                  return (\n                    <MediaPathSearchResult\n                      key={result.url}\n                      {...result}\n                      setMedia={setMedia}\n                    />\n                  );\n                }\n                return (\n                  <StreamPathSearchResult\n                    key={result.url}\n                    {...result}\n                    setMedia={setMedia}\n                    launchMultiSelect={this.props.launchMultiSelect as Function}\n                    streamPath={this.props.streamPath || ''}\n                  />\n                );\n              })}\n            </Dropdown.Menu>\n          ) : null}\n        </Dropdown>\n      </React.Fragment>\n    );\n  }\n}\n"]},"metadata":{},"sourceType":"module"}