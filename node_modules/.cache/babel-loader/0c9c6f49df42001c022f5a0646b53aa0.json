{"ast":null,"code":"import _regeneratorRuntime from\"/home/runner/work/watchparty/watchparty/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/runner/work/watchparty/watchparty/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/home/runner/work/watchparty/watchparty/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/runner/work/watchparty/watchparty/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/home/runner/work/watchparty/watchparty/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/home/runner/work/watchparty/watchparty/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React from'react';import{serverPath,colorMappings,getUserImage}from'../../utils';import{Icon,Popup,Button,Dropdown,Image}from'semantic-ui-react';import firebase from'firebase/compat/app';import'firebase/compat/auth';import{LoginModal}from'../Modal/LoginModal';import axios from'axios';import{SubscribeButton}from'../SubscribeButton/SubscribeButton';import{ProfileModal}from'../Modal/ProfileModal';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export var NewRoomButton=/*#__PURE__*/function(_React$Component){_inherits(NewRoomButton,_React$Component);var _super=_createSuper(NewRoomButton);function NewRoomButton(){var _this;_classCallCheck(this,NewRoomButton);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.createRoom=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _this$props$user,_this$props$user2;var uid,token,response,data,name;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:uid=(_this$props$user=_this.props.user)===null||_this$props$user===void 0?void 0:_this$props$user.uid;_context.next=3;return(_this$props$user2=_this.props.user)===null||_this$props$user2===void 0?void 0:_this$props$user2.getIdToken();case 3:token=_context.sent;_context.next=6;return window.fetch(serverPath+'/createRoom',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({uid:uid,token:token})});case 6:response=_context.sent;_context.next=9;return response.json();case 9:data=_context.sent;name=data.name;if(_this.props.openNewTab){window.open('/#'+name);}else{window.location.assign('/#'+name);}case 12:case\"end\":return _context.stop();}}},_callee);}));return _this;}_createClass(NewRoomButton,[{key:\"render\",value:function render(){return/*#__PURE__*/_jsx(Popup,{content:\"Create a new room with a random URL that you can share with friends\",trigger:/*#__PURE__*/_jsxs(Button,{color:\"blue\",size:this.props.size,icon:true,labelPosition:\"left\",onClick:this.createRoom,className:\"toolButton\",fluid:true,children:[/*#__PURE__*/_jsx(Icon,{name:\"certificate\"}),\"New Room\"]})});}}]);return NewRoomButton;}(React.Component);export var SignInButton=/*#__PURE__*/function(_React$Component2){_inherits(SignInButton,_React$Component2);var _super2=_createSuper(SignInButton);function SignInButton(){var _this2;_classCallCheck(this,SignInButton);for(var _len2=arguments.length,args=new Array(_len2),_key2=0;_key2<_len2;_key2++){args[_key2]=arguments[_key2];}_this2=_super2.call.apply(_super2,[this].concat(args));_this2.state={isLoginOpen:false,isProfileOpen:false,userImage:null};_this2.facebookSignIn=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var provider;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:provider=new firebase.auth.FacebookAuthProvider();_context2.next=3;return firebase.auth().signInWithPopup(provider);case 3:case\"end\":return _context2.stop();}}},_callee2);}));_this2.googleSignIn=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){var provider;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:provider=new firebase.auth.GoogleAuthProvider();_context3.next=3;return firebase.auth().signInWithPopup(provider);case 3:case\"end\":return _context3.stop();}}},_callee3);}));_this2.signOut=function(){firebase.auth().signOut();window.location.reload();};return _this2;}_createClass(SignInButton,[{key:\"componentDidUpdate\",value:function(){var _componentDidUpdate=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(prevProps){return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:if(!(!prevProps.user&&this.props.user)){_context4.next=7;break;}_context4.t0=this;_context4.next=4;return getUserImage(this.props.user);case 4:_context4.t1=_context4.sent;_context4.t2={userImage:_context4.t1};_context4.t0.setState.call(_context4.t0,_context4.t2);case 7:case\"end\":return _context4.stop();}}},_callee4,this);}));function componentDidUpdate(_x){return _componentDidUpdate.apply(this,arguments);}return componentDidUpdate;}()},{key:\"render\",value:function render(){var _this3=this;if(this.props.user){return/*#__PURE__*/_jsxs(\"div\",{style:{margin:'4px',width:'100px',alignItems:'center',cursor:'pointer'},children:[/*#__PURE__*/_jsx(Image,{avatar:true,src:this.state.userImage,onClick:function onClick(){return _this3.setState({isProfileOpen:true});}}),this.state.isProfileOpen&&this.props.user&&/*#__PURE__*/_jsx(ProfileModal,{user:this.props.user,userImage:this.state.userImage,close:function close(){return _this3.setState({isProfileOpen:false});}})]});}return/*#__PURE__*/_jsxs(React.Fragment,{children:[this.state.isLoginOpen&&/*#__PURE__*/_jsx(LoginModal,{closeLogin:function closeLogin(){return _this3.setState({isLoginOpen:false});}}),/*#__PURE__*/_jsx(Popup,{basic:true,content:\"Sign in to set your name and picture, subscribe, or launch VBrowsers\",trigger:/*#__PURE__*/_jsx(Dropdown,{style:{height:'36px'},icon:\"sign in\",labeled:true,className:\"icon\",button:true,text:\"Sign in\",fluid:this.props.fluid,children:/*#__PURE__*/_jsxs(Dropdown.Menu,{children:[/*#__PURE__*/_jsxs(Dropdown.Item,{onClick:this.facebookSignIn,children:[/*#__PURE__*/_jsx(Icon,{name:\"facebook\"}),\"Facebook\"]}),/*#__PURE__*/_jsxs(Dropdown.Item,{onClick:this.googleSignIn,children:[/*#__PURE__*/_jsx(Icon,{name:\"google\"}),\"Google\"]}),/*#__PURE__*/_jsxs(Dropdown.Item,{onClick:function onClick(){return _this3.setState({isLoginOpen:true});},children:[/*#__PURE__*/_jsx(Icon,{name:\"mail\"}),\"Email\"]})]})})})]});}}]);return SignInButton;}(React.Component);export var ListRoomsButton=/*#__PURE__*/function(_React$Component3){_inherits(ListRoomsButton,_React$Component3);var _super3=_createSuper(ListRoomsButton);function ListRoomsButton(){var _this4;_classCallCheck(this,ListRoomsButton);for(var _len3=arguments.length,args=new Array(_len3),_key3=0;_key3<_len3;_key3++){args[_key3]=arguments[_key3];}_this4=_super3.call.apply(_super3,[this].concat(args));_this4.state={rooms:[]};_this4.refreshRooms=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(){var _this4$props$user,token,response;return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:if(!_this4.props.user){_context5.next=8;break;}_context5.next=3;return _this4.props.user.getIdToken();case 3:token=_context5.sent;_context5.next=6;return axios.get(serverPath+\"/listRooms?uid=\".concat((_this4$props$user=_this4.props.user)===null||_this4$props$user===void 0?void 0:_this4$props$user.uid,\"&token=\").concat(token));case 6:response=_context5.sent;_this4.setState({rooms:response.data});case 8:case\"end\":return _context5.stop();}}},_callee5);}));_this4.deleteRoom=/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee6(roomId){var _this4$props$user2,token;return _regeneratorRuntime.wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:if(!_this4.props.user){_context6.next=8;break;}_context6.next=3;return _this4.props.user.getIdToken();case 3:token=_context6.sent;_context6.next=6;return axios.delete(serverPath+\"/deleteRoom?uid=\".concat((_this4$props$user2=_this4.props.user)===null||_this4$props$user2===void 0?void 0:_this4$props$user2.uid,\"&token=\").concat(token,\"&roomId=\").concat(roomId));case 6:_this4.setState({rooms:_this4.state.rooms.filter(function(room){return room.roomId!==roomId;})});_this4.refreshRooms();case 8:case\"end\":return _context6.stop();}}},_callee6);}));return function(_x2){return _ref5.apply(this,arguments);};}();return _this4;}_createClass(ListRoomsButton,[{key:\"componentDidMount\",value:function componentDidMount(){this.refreshRooms();}},{key:\"render\",value:function render(){var _this5=this;return/*#__PURE__*/_jsx(Dropdown,{style:{height:'36px'},icon:\"group\",labeled:true,className:\"icon\",button:true,text:\"My Rooms\",onClick:this.refreshRooms,scrolling:true,children:/*#__PURE__*/_jsxs(Dropdown.Menu,{children:[this.state.rooms.length===0&&/*#__PURE__*/_jsx(Dropdown.Item,{disabled:true,children:\"You have no permanent rooms.\"}),this.state.rooms.map(function(room){return/*#__PURE__*/_jsx(Dropdown.Item,{link:true,href:room.vanity?'/r/'+room.vanity:'/'+room.roomId.replace('/','#'),onClick:function onClick(){if(!room.vanity){setTimeout(function(){return window.location.reload();},100);}},children:/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',alignItems:'center'},children:[room.vanity?\"/r/\".concat(room.vanity):room.roomId.replace('/','#'),/*#__PURE__*/_jsx(\"div\",{style:{marginLeft:'auto',paddingLeft:'20px'},children:/*#__PURE__*/_jsx(Button,{icon:true,onClick:function onClick(e){e.stopPropagation();e.nativeEvent.stopImmediatePropagation();_this5.deleteRoom(room.roomId);},color:\"red\",size:\"mini\",children:/*#__PURE__*/_jsx(Icon,{name:\"trash\"})})})]})});})]})});}}]);return ListRoomsButton;}(React.Component);export var TopBar=/*#__PURE__*/function(_React$Component4){_inherits(TopBar,_React$Component4);var _super4=_createSuper(TopBar);function TopBar(){_classCallCheck(this,TopBar);return _super4.apply(this,arguments);}_createClass(TopBar,[{key:\"render\",value:function render(){var _this$props$isSubscri,_this$props$isCustome;var subscribeButton=/*#__PURE__*/_jsx(SubscribeButton,{user:this.props.user,isSubscriber:(_this$props$isSubscri=this.props.isSubscriber)!==null&&_this$props$isSubscri!==void 0?_this$props$isSubscri:false,isCustomer:(_this$props$isCustome=this.props.isCustomer)!==null&&_this$props$isCustome!==void 0?_this$props$isCustome:false});return/*#__PURE__*/_jsx(React.Fragment,{children:/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',flexWrap:'wrap',padding:'1em',paddingBottom:'0px'},children:[/*#__PURE__*/_jsxs(\"a\",{href:\"/\",style:{display:'flex'},children:[/*#__PURE__*/_jsxs(\"div\",{style:{height:'48px',width:'48px',marginRight:'10px',borderRadius:'50%',position:'relative',backgroundColor:'#'+colorMappings.blue},children:[/*#__PURE__*/_jsx(Icon,{inverted:true,name:\"film\",size:\"large\",style:{position:'absolute',top:8,width:'100%',margin:'0 auto'}}),/*#__PURE__*/_jsx(Icon,{inverted:true,name:\"group\",size:\"large\",color:\"green\",style:{position:'absolute',bottom:8,width:'100%',margin:'0 auto'}})]}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',alignItems:'center'},children:[/*#__PURE__*/_jsx(\"div\",{style:{textTransform:'uppercase',fontWeight:700,color:'#2185d0',fontSize:'30px',lineHeight:'30px'},children:\"Watch\"}),/*#__PURE__*/_jsx(\"div\",{style:{textTransform:'uppercase',fontWeight:700,color:'#21ba45',fontSize:'30px',lineHeight:'30px',marginLeft:'auto'},children:\"Party\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',marginLeft:'10px',alignItems:'center'},children:[/*#__PURE__*/_jsx(\"a\",{href:\"https://discord.gg/3rYj5HV\",target:\"_blank\",rel:\"noopener noreferrer\",className:\"footerIcon\",title:\"Discord\",children:/*#__PURE__*/_jsx(Icon,{name:\"discord\",size:\"big\",link:true})}),/*#__PURE__*/_jsx(\"a\",{href:\"https://github.com/howardchung/watchparty\",target:\"_blank\",rel:\"noopener noreferrer\",className:\"footerIcon\",title:\"GitHub\",children:/*#__PURE__*/_jsx(Icon,{name:\"github\",size:\"big\",link:true})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mobileStack\",style:{display:'flex',marginLeft:'auto',gap:'4px'},children:[!this.props.hideNewRoom&&/*#__PURE__*/_jsx(NewRoomButton,{user:this.props.user,openNewTab:true}),!this.props.hideMyRooms&&this.props.user&&/*#__PURE__*/_jsx(ListRoomsButton,{user:this.props.user}),subscribeButton,!this.props.hideSignin&&/*#__PURE__*/_jsx(SignInButton,{user:this.props.user})]})]})});}}]);return TopBar;}(React.Component);","map":{"version":3,"sources":["/home/runner/work/watchparty/watchparty/src/components/TopBar/TopBar.tsx"],"names":["React","serverPath","colorMappings","getUserImage","Icon","Popup","Button","Dropdown","Image","firebase","LoginModal","axios","SubscribeButton","ProfileModal","NewRoomButton","createRoom","uid","props","user","getIdToken","token","window","fetch","method","headers","body","JSON","stringify","response","json","data","name","openNewTab","open","location","assign","size","Component","SignInButton","state","isLoginOpen","isProfileOpen","userImage","facebookSignIn","provider","auth","FacebookAuthProvider","signInWithPopup","googleSignIn","GoogleAuthProvider","signOut","reload","prevProps","setState","margin","width","alignItems","cursor","height","fluid","ListRoomsButton","rooms","refreshRooms","get","deleteRoom","roomId","delete","filter","room","length","map","vanity","replace","setTimeout","display","marginLeft","paddingLeft","e","stopPropagation","nativeEvent","stopImmediatePropagation","TopBar","subscribeButton","isSubscriber","isCustomer","flexWrap","padding","paddingBottom","marginRight","borderRadius","position","backgroundColor","blue","top","bottom","textTransform","fontWeight","color","fontSize","lineHeight","gap","hideNewRoom","hideMyRooms","hideSignin"],"mappings":"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","sourcesContent":["import React from 'react';\nimport { serverPath, colorMappings, getUserImage } from '../../utils';\nimport { Icon, Popup, Button, Dropdown, Image } from 'semantic-ui-react';\nimport firebase from 'firebase/compat/app';\nimport 'firebase/compat/auth';\nimport { LoginModal } from '../Modal/LoginModal';\nimport axios from 'axios';\nimport { SubscribeButton } from '../SubscribeButton/SubscribeButton';\nimport { ProfileModal } from '../Modal/ProfileModal';\n\nexport class NewRoomButton extends React.Component<{\n  user: firebase.User | undefined;\n  size?: string;\n  openNewTab?: boolean;\n}> {\n  createRoom = async () => {\n    const uid = this.props.user?.uid;\n    const token = await this.props.user?.getIdToken();\n    const response = await window.fetch(serverPath + '/createRoom', {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify({\n        uid,\n        token,\n      }),\n    });\n    const data = await response.json();\n    const { name } = data;\n    if (this.props.openNewTab) {\n      window.open('/#' + name);\n    } else {\n      window.location.assign('/#' + name);\n    }\n  };\n  render() {\n    return (\n      <Popup\n        content=\"Create a new room with a random URL that you can share with friends\"\n        trigger={\n          <Button\n            color=\"blue\"\n            size={this.props.size as any}\n            icon\n            labelPosition=\"left\"\n            onClick={this.createRoom}\n            className=\"toolButton\"\n            fluid\n          >\n            <Icon name=\"certificate\" />\n            New Room\n          </Button>\n        }\n      />\n    );\n  }\n}\n\ntype SignInButtonProps = {\n  user: firebase.User | undefined;\n  fluid?: boolean;\n};\n\nexport class SignInButton extends React.Component<SignInButtonProps> {\n  public state = { isLoginOpen: false, isProfileOpen: false, userImage: null };\n\n  async componentDidUpdate(prevProps: SignInButtonProps) {\n    if (!prevProps.user && this.props.user) {\n      this.setState({ userImage: await getUserImage(this.props.user) });\n    }\n  }\n\n  facebookSignIn = async () => {\n    const provider = new firebase.auth.FacebookAuthProvider();\n    await firebase.auth().signInWithPopup(provider);\n  };\n\n  googleSignIn = async () => {\n    const provider = new firebase.auth.GoogleAuthProvider();\n    await firebase.auth().signInWithPopup(provider);\n  };\n\n  signOut = () => {\n    firebase.auth().signOut();\n    window.location.reload();\n  };\n\n  render() {\n    if (this.props.user) {\n      return (\n        <div\n          style={{\n            margin: '4px',\n            width: '100px',\n            alignItems: 'center',\n            cursor: 'pointer',\n          }}\n        >\n          <Image\n            avatar\n            src={this.state.userImage}\n            onClick={() => this.setState({ isProfileOpen: true })}\n          />\n          {this.state.isProfileOpen && this.props.user && (\n            <ProfileModal\n              user={this.props.user}\n              userImage={this.state.userImage}\n              close={() => this.setState({ isProfileOpen: false })}\n            />\n          )}\n        </div>\n      );\n    }\n    return (\n      <React.Fragment>\n        {this.state.isLoginOpen && (\n          <LoginModal\n            closeLogin={() => this.setState({ isLoginOpen: false })}\n          />\n        )}\n        <Popup\n          basic\n          content=\"Sign in to set your name and picture, subscribe, or launch VBrowsers\"\n          trigger={\n            <Dropdown\n              style={{ height: '36px' }}\n              icon=\"sign in\"\n              labeled\n              className=\"icon\"\n              button\n              text=\"Sign in\"\n              fluid={this.props.fluid}\n            >\n              <Dropdown.Menu>\n                <Dropdown.Item onClick={this.facebookSignIn}>\n                  <Icon name=\"facebook\" />\n                  Facebook\n                </Dropdown.Item>\n                <Dropdown.Item onClick={this.googleSignIn}>\n                  <Icon name=\"google\" />\n                  Google\n                </Dropdown.Item>\n                <Dropdown.Item\n                  onClick={() => this.setState({ isLoginOpen: true })}\n                >\n                  <Icon name=\"mail\" />\n                  Email\n                </Dropdown.Item>\n              </Dropdown.Menu>\n            </Dropdown>\n          }\n        />\n      </React.Fragment>\n    );\n  }\n}\n\nexport class ListRoomsButton extends React.Component<{\n  user: firebase.User | undefined;\n}> {\n  public state = { rooms: [] as PersistentRoom[] };\n\n  componentDidMount() {\n    this.refreshRooms();\n  }\n\n  refreshRooms = async () => {\n    if (this.props.user) {\n      const token = await this.props.user.getIdToken();\n      const response = await axios.get(\n        serverPath + `/listRooms?uid=${this.props.user?.uid}&token=${token}`\n      );\n      this.setState({ rooms: response.data });\n    }\n  };\n\n  deleteRoom = async (roomId: string) => {\n    if (this.props.user) {\n      const token = await this.props.user.getIdToken();\n      await axios.delete(\n        serverPath +\n          `/deleteRoom?uid=${this.props.user?.uid}&token=${token}&roomId=${roomId}`\n      );\n      this.setState({\n        rooms: this.state.rooms.filter((room) => room.roomId !== roomId),\n      });\n      this.refreshRooms();\n    }\n  };\n\n  render() {\n    return (\n      <Dropdown\n        style={{ height: '36px' }}\n        icon=\"group\"\n        labeled\n        className=\"icon\"\n        button\n        text=\"My Rooms\"\n        onClick={this.refreshRooms}\n        scrolling\n      >\n        <Dropdown.Menu>\n          {this.state.rooms.length === 0 && (\n            <Dropdown.Item disabled>You have no permanent rooms.</Dropdown.Item>\n          )}\n          {this.state.rooms.map((room: any) => {\n            return (\n              <Dropdown.Item\n                link\n                href={\n                  room.vanity\n                    ? '/r/' + room.vanity\n                    : '/' + room.roomId.replace('/', '#')\n                }\n                onClick={() => {\n                  if (!room.vanity) {\n                    setTimeout(() => window.location.reload(), 100);\n                  }\n                }}\n              >\n                <div style={{ display: 'flex', alignItems: 'center' }}>\n                  {room.vanity\n                    ? `/r/${room.vanity}`\n                    : room.roomId.replace('/', '#')}\n                  <div style={{ marginLeft: 'auto', paddingLeft: '20px' }}>\n                    <Button\n                      icon\n                      onClick={(e: React.MouseEvent) => {\n                        e.stopPropagation();\n                        e.nativeEvent.stopImmediatePropagation();\n                        this.deleteRoom(room.roomId);\n                      }}\n                      color=\"red\"\n                      size=\"mini\"\n                    >\n                      <Icon name=\"trash\" />\n                    </Button>\n                  </div>\n                </div>\n              </Dropdown.Item>\n            );\n          })}\n        </Dropdown.Menu>\n      </Dropdown>\n    );\n  }\n}\n\nexport class TopBar extends React.Component<{\n  user?: firebase.User;\n  hideNewRoom?: boolean;\n  hideSignin?: boolean;\n  hideMyRooms?: boolean;\n  isSubscriber: boolean;\n  isCustomer: boolean;\n}> {\n  render() {\n    const subscribeButton = (\n      <SubscribeButton\n        user={this.props.user}\n        isSubscriber={this.props.isSubscriber ?? false}\n        isCustomer={this.props.isCustomer ?? false}\n      />\n    );\n    return (\n      <React.Fragment>\n        <div\n          style={{\n            display: 'flex',\n            flexWrap: 'wrap',\n            padding: '1em',\n            paddingBottom: '0px',\n          }}\n        >\n          <a href=\"/\" style={{ display: 'flex' }}>\n            <div\n              style={{\n                height: '48px',\n                width: '48px',\n                marginRight: '10px',\n                borderRadius: '50%',\n                position: 'relative',\n                backgroundColor: '#' + colorMappings.blue,\n              }}\n            >\n              <Icon\n                inverted\n                name=\"film\"\n                size=\"large\"\n                style={{\n                  position: 'absolute',\n                  top: 8,\n                  width: '100%',\n                  margin: '0 auto',\n                }}\n              />\n              <Icon\n                inverted\n                name=\"group\"\n                size=\"large\"\n                color=\"green\"\n                style={{\n                  position: 'absolute',\n                  bottom: 8,\n                  width: '100%',\n                  margin: '0 auto',\n                }}\n              />\n            </div>\n            <div\n              style={{\n                display: 'flex',\n                alignItems: 'center',\n              }}\n            >\n              <div\n                style={{\n                  textTransform: 'uppercase',\n                  fontWeight: 700,\n                  color: '#2185d0',\n                  fontSize: '30px',\n                  lineHeight: '30px',\n                }}\n              >\n                Watch\n              </div>\n              <div\n                style={{\n                  textTransform: 'uppercase',\n                  fontWeight: 700,\n                  color: '#21ba45',\n                  fontSize: '30px',\n                  lineHeight: '30px',\n                  marginLeft: 'auto',\n                }}\n              >\n                Party\n              </div>\n            </div>\n          </a>\n          <div\n            style={{\n              display: 'flex',\n              marginLeft: '10px',\n              alignItems: 'center',\n            }}\n          >\n            <a\n              href=\"https://discord.gg/3rYj5HV\"\n              target=\"_blank\"\n              rel=\"noopener noreferrer\"\n              className=\"footerIcon\"\n              title=\"Discord\"\n            >\n              <Icon name=\"discord\" size=\"big\" link />\n            </a>\n            <a\n              href=\"https://github.com/howardchung/watchparty\"\n              target=\"_blank\"\n              rel=\"noopener noreferrer\"\n              className=\"footerIcon\"\n              title=\"GitHub\"\n            >\n              <Icon name=\"github\" size=\"big\" link />\n            </a>\n          </div>\n          <div\n            className=\"mobileStack\"\n            style={{\n              display: 'flex',\n              marginLeft: 'auto',\n              gap: '4px',\n            }}\n          >\n            {!this.props.hideNewRoom && (\n              <NewRoomButton user={this.props.user} openNewTab />\n            )}\n            {!this.props.hideMyRooms && this.props.user && (\n              <ListRoomsButton user={this.props.user} />\n            )}\n            {subscribeButton}\n            {!this.props.hideSignin && <SignInButton user={this.props.user} />}\n          </div>\n        </div>\n      </React.Fragment>\n    );\n  }\n}\n"]},"metadata":{},"sourceType":"module"}